<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Error al generar pedido</title>
    <link rel="stylesheet" href="produ.css">
 
</head>
<body>

  <h2>Hubo un error, pero te damos otra solución</h2>

  <div class="aviso">
    <p>Descargá el comprobante y enviánoslo manualmente por WhatsApp haciendo clic en el botón de abajo.</p>
  </div>

  <div class="resumen" id="resumen-pedido"></div>

  <button class="boton" id="descargarPDF">Descargar PDF</button>

  <script>
    const datos = JSON.parse(localStorage.getItem('pedidoBackup'));

    const contenedor = document.getElementById('resumen-pedido');
    if (datos) {
      let html = `
        <h3>Datos del cliente</h3>
        <p><strong>Nombre:</strong> ${datos.cliente.nombreApellido}</p>
        <p><strong>DNI:</strong> ${datos.cliente.dni}</p>
        <p><strong>Celular:</strong> ${datos.cliente.celular}</p>
        <p><strong>Provincia:</strong> ${datos.cliente.provincia}</p>
        <p><strong>Localidad:</strong> ${datos.cliente.localidad}</p>
        <p><strong>Código Postal:</strong> ${datos.cliente.cp}</p>
        <p><strong>Correo:</strong> ${datos.cliente.mail}</p>
        <p><strong>Método de Envío:</strong> ${datos.cliente.metodoEnvio}</p>
        <h3>Productos</h3>
      `;

      let total = 0;
     datos.carrito.forEach((prod, i) => {
  const subtotal = prod.precio * prod.cantidad;
  total += subtotal;
  html += `
    <div class="producto">
      <img src="${prod.imagen}" alt="${prod.nombre}" />
      <div class="info-producto">
        <p><strong>${i + 1}. ${prod.nombre}</strong></p>
        <p>Precio: $${prod.precio} - Cantidad: ${prod.cantidad}</p>
        <p>Subtotal: $${subtotal}</p>
      </div>
    </div>
  `;
});


      html += `<h3>Total: $${total}</h3>`;
      contenedor.innerHTML = html;
    }

    document.getElementById('descargarPDF').addEventListener('click', () => {
      const link = document.createElement('a');
      link.href = datos.pdfDataURL;
      link.download = 'comprobante.pdf';
      link.click();
    });
  </script>
</body>
</html>
